<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>블로그 에디터 예시</title>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
      }

      #editor {
        position: relative;
        padding: 20px;
      }

      .image-container {
        position: relative;
        display: inline-block;
        margin-bottom: 10px;
      }

      .image-container img {
        max-width: 100%;
      }

      .delete-button {
        position: absolute;
        top: 5px;
        right: 5px;
        cursor: pointer;
        background-color: #e74c3c;
        color: #fff;
        border: none;
        padding: 4px 8px;
        font-size: 12px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1; /* 다른 내용 위에 표시되도록 설정 */
      }

      .delete-button:hover {
        background-color: #c0392b;
      }

      .delete-button svg {
        width: 12px;
        height: 12px;
        fill: #fff;
      }

      #fileInput {
        display: none;
      }

      #insertImageButton {
        cursor: pointer;
        background-color: #3498db;
        color: #fff;
        border: none;
        padding: 8px 12px;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <!-- 이미지를 업로드할 input 요소 -->
    <input
      type="file"
      id="fileInput"
      accept="image/*"
      style="display: none"
      onchange="addImage(event)"
    />
    <button
      id="insertImageButton"
      onclick="document.getElementById('fileInput').click()"
    >
      이미지 삽입
    </button>

    <!-- 에디터 영역 -->
    <div id="editor" contenteditable="true"></div>

    <!-- 삭제 버튼 템플릿 -->
    <button id="deleteButtonTemplate" class="delete-button">
      <svg viewBox="0 0 24 24">
        <path
          d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
        />
      </svg>
    </button>

    <script>
      document
        .getElementById('fileInput')
        .addEventListener('change', function (event) {
          addImage(event);
        });

      function addImage(event) {
        const fileInput = event.target;
        const files = fileInput.files;

        if (files.length === 0) {
          return;
        }

        const imageFile = files[0];
        const imageUrl = URL.createObjectURL(imageFile);

        // 이미지 엘리먼트와 삭제 버튼을 감싸는 컨테이너 생성
        const container = document.createElement('div');
        container.className = 'image-container';

        const img = document.createElement('img');
        img.src = imageUrl;
        img.alt = '이미지 설명';

        // 삭제 버튼을 템플릿에서 복제하여 생성
        const deleteButton = document
          .getElementById('deleteButtonTemplate')
          .cloneNode(true);
        deleteButton.onclick = function () {
          // 삭제 버튼 클릭 시 컨테이너 제거
          container.remove();
        };

        // 컨테이너에 이미지 추가
        container.appendChild(img);
        // 컨테이너에 삭제 버튼 추가
        container.appendChild(deleteButton);

        // 에디터에 이미지 컨테이너 추가
        const editor = document.getElementById('editor');
        editor.appendChild(container);

        // 파일 입력 필드 초기화
        fileInput.value = '';
      }
    </script>
  </body>
</html>
